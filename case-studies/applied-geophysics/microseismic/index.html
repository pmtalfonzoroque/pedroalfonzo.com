<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Microseismic Monitoring ‚Äì Conceptual Workflow</title>

  <!-- FONT AWESOME ICONS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <!-- GLOBAL CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

  <!-- LOCAL CSS -->
  <link rel="stylesheet" href="style.css">
</head>

<body class="page page-background-sky">

  <!-- HEADER -->
  <div id="header"></div>

  <main class="content">

    <!-- PAGE TITLE -->
    <h1>Microseismic Monitoring</h1>
    <p class="intro">
      Conceptual workflow for event detection and interpretation in potash mining.
    </p>

    <!-- WHY IT MATTERS -->
    <section>
      <h2>Why Microseismic Monitoring Matters</h2>
      <p>
        Microseismic monitoring helps detect small-scale rock mass movements that are not visible 
        through traditional inspection. In high-conductivity environments like potash mines, 
        microseismic data supports ground control, safety, and operational decision-making.
      </p>
    </section>

    <!-- WORKFLOW -->
    <section>
      <h2>Conceptual Workflow</h2>
      <ol>
        <li><strong>Sensor Layout:</strong> Geophones or accelerometers installed in drifts or boreholes.</li>
        <li><strong>Noise Filtering:</strong> Removing machinery noise, ventilation noise, and background vibrations.</li>
        <li><strong>Event Detection:</strong> Identifying small seismic events within noisy data.</li>
        <li><strong>Event Location:</strong> Triangulating source position using arrival times.</li>
        <li><strong>Interpretation:</strong> Understanding rock mass behavior and potential instability.</li>
      </ol>
    </section>

    <!-- INTERACTIVE JS DEMO -->
    <section>
      <h2>Interactive Example ‚Äì Raw vs Filtered Signal</h2>
      <p>This simple synthetic example illustrates how filtering improves event visibility.</p>

      <div class="seismogram-container">
        <canvas id="waveformCanvas"></canvas>
      </div>

      <button id="toggleButton">Show Filtered Signal</button>
      <script src="script.js"></script>
    </section>

    <!-- PYTHON VIDEO -->
    <section>
      <h2>Python Demo ‚Äì Synthetic Microseismic Events</h2>
      <p>
        This short Python demonstration shows how synthetic microseismic events can be generated,
        filtered, and detected. It illustrates the first step of a real microseismic workflow:
        identifying event candidates within noisy data.
      </p>

      <h3>Level 1: Single-Trace Event Detection</h3>
      <p>
        The video below walks through the raw signal, the filtered signal, and the detection of
        local maxima (event candidates). This conceptual example is designed for educational
        purposes and mirrors the early stages of microseismic processing.
      </p>

      <div class="video-container">
        <iframe 
            src="https://www.youtube.com/embed/3s4gJdRp-q4?modestbranding=1&rel=0&showinfo=0"
            title="Microseismic Event Detection ‚Äì Level 1 Demo"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
        </iframe>
      </div>
    </section>

    <!-- LEVEL 2 -->
    <section>
      <h2>Level 2: Multi‚ÄëGeophone Synthetic Microseismic Example</h2>

      <p>
        Educational synthetic example using six geophones. A single microseismic event is recorded 
        across the array, with arrival times adjusted for visualization. The left panel shows the 
        filtered traces with detected peaks, and the right panel displays the corresponding 
        travel‚Äëtime trend across the geophones.
      </p>

      <img class="level2-image" src="/assets/images/microseismic_level2_multigeophone.JPG" 
          alt="Level 2 ‚Äì Multi-Geophone Synthetic Microseismic Event">

      <p class="caption">
        Figure: A single synthetic microseismic event recorded across six geophones. 
        Left: filtered traces with detected arrivals. Right: travel‚Äëtime trend used for 
        basic quality control and interpretation.
      </p>
    </section>

    <!-- LEVEL 3 -->
    <section>
      <h2>Level 3: From Arrival Times to Event Location</h2>
      <p>
        Building on the multi‚Äëgeophone example from Level 2, this section demonstrates how 
        arrival‚Äëtime differences can be used to estimate the location of a microseismic event. 
        The goal is to illustrate the core idea behind travel‚Äëtime inversion using a simple 
        synthetic example with six geophones.
      </p>
    </section>

    <section>
      <h3>3.1 Synthetic Setup</h3>
      <p>
        To remain consistent with Level 2, this example uses six geophones placed along a 
        horizontal drift. A synthetic microseismic event is defined below the array, and 
        theoretical travel times are computed using a constant velocity. Small perturbations 
        are added to mimic realistic picking uncertainty.
      </p>
    </section>

    <!-- COLLAPSIBLE: numeric/code details for setup -->
    <div class="info-box-collapsible">
      <button class="collapsible-btn" onclick="toggleSection('level3setup')">
        <span class="icon">üìê</span> Numeric details (show/hide)
        <span class="arrow">‚ñº</span>
      </button>

      <div id="level3setup" class="info-content">
        <pre><code>
    // Six geophones along a drift (meters)
    G = [
      {x: 0,  y: 0, z: 0},
      {x: 5,  y: 0, z: 0},
      {x: 10, y: 0, z: 0},
      {x: 15, y: 0, z: 0},
      {x: 20, y: 0, z: 0},
      {x: 25, y: 0, z: 0}
    ];

    // True event location
    E_true = {x: 12, y: 0, z: -18};

    // Velocity (m/s)
    v = 2500;

    // Travel-time function
    function travelTime(G, E, v) {
      let dx = G.x - E.x;
      let dy = G.y - E.y;
      let dz = G.z - E.z;
      let d  = Math.sqrt(dx*dx + dy*dy + dz*dz);
      return d / v;
    }
        </code></pre>
      </div>
    </div>

    <section>
      <h3>3.2 Arrival‚ÄëTime Inversion</h3>
      <p>
        Because the event origin time is unknown, the inversion uses arrival‚Äëtime differences 
        between geophones. With six sensors, the system is over‚Äëdetermined, which stabilizes 
        the solution and reduces sensitivity to noise. A simple 2D grid‚Äësearch inversion is 
        used for clarity.
      </p>
    </section>

    <!-- COLLAPSIBLE: numeric/code details for inversion -->
    <div class="info-box-collapsible">
      <button class="collapsible-btn" onclick="toggleSection('level3invert')">
        <span class="icon">üîß</span> Inversion details (show/hide)
        <span class="arrow">‚ñº</span>
      </button>

      <div id="level3invert" class="info-content">
        <pre><code>
    // Synthetic observed arrival times (with small noise)
    t_obs = G.map(g => travelTime(g, E_true, v) + (Math.random()*0.002 - 0.001));

    // Grid-search inversion
    function invertLocation(G, t_obs, v) {
      let best = {x: 0, z: 0, misfit: 1e9};

      for (let x = 0; x <= 25; x += 0.2) {
        for (let z = -40; z <= -5; z += 0.2) {
          let E = {x: x, y: 0, z: z};
          let t_calc = G.map(g => travelTime(g, E, v));

          let mis = 0;
          for (let i = 0; i < G.length - 1; i++) {
            let dt_obs  = t_obs[i+1] - t_obs[i];
            let dt_calc = t_calc[i+1] - t_calc[i];
            mis += Math.pow(dt_calc - dt_obs, 2);
          }

          if (mis < best.misfit) best = {x: x, z: z, misfit: mis};
        }
      }
      return best;
    }

    E_est = invertLocation(G, t_obs, v);
        </code></pre>
      </div>
    </div>

    <!-- REAL JAVASCRIPT (executed) -->
    <script>
    // Six geophones along a drift
    var G = [
      {x: 0,  y: 0, z: 0},
      {x: 5,  y: 0, z: 0},
      {x: 10, y: 0, z: 0},
      {x: 15, y: 0, z: 0},
      {x: 20, y: 0, z: 0},
      {x: 25, y: 0, z: 0}
    ];

    var E_true = {x: 12, y: 0, z: -18};
    var v = 2500;

    function travelTime(G, E, v) {
      let dx = G.x - E.x;
      let dy = G.y - E.y;
      let dz = G.z - E.z;
      let d  = Math.sqrt(dx*dx + dy*dy + dz*dz);
      return d / v;
    }

    var t_obs = G.map(g => travelTime(g, E_true, v) + (Math.random()*0.002 - 0.001));

    function invertLocation(G, t_obs, v) {

      // We will store the best (lowest) misfit found so far.
      // Start with a huge number so the first real misfit will replace it.
      let best = {x: 0, z: 0, misfit: 1e9};

      // Loop over a 2D grid of possible event locations.
      // x goes from 0 to 25 m, z goes from -40 m to -5 m.
      // This is a brute‚Äëforce grid search.
      for (let x = 0; x <= 25; x += 0.2) {
        for (let z = -40; z <= -5; z += 0.2) {

          // Trial event location
          let E = {x: x, y: 0, z: z};

          // Compute theoretical arrival times for this trial location
          let t_calc = G.map(g => travelTime(g, E, v));

          // Initialize misfit for this trial location.
          // "mis" = misfit = how wrong this location is.
          let mis = 0;

          // Compare arrival‚Äëtime differences between geophones.
          // We use differences because the origin time is unknown.
          for (let i = 0; i < G.length - 1; i++) {

            // Observed time difference between geophone i and i+1
            let dt_obs  = t_obs[i+1] - t_obs[i];

            // Calculated time difference for this trial location
            let dt_calc = t_calc[i+1] - t_calc[i];

            // Add squared error to misfit.
            // Squaring avoids cancellation and penalizes large errors.
            mis += Math.pow(dt_calc - dt_obs, 2);
          }

          // If this trial location fits the data better than previous ones,
          // store it as the new best solution.
          if (mis < best.misfit) {
            best = {x: x, z: z, misfit: mis};
          }
        }
      }

      // Return the best‚Äëfitting event location
      return best;
    }


    var E_est = invertLocation(G, t_obs, v);
    </script>

    <section>
      <h3>3.3 Estimated Event Location</h3>
      <p>
        The cross‚Äësection below shows the six geophones, the true synthetic event, and the 
        estimated event obtained from the arrival‚Äëtime inversion. The small offset between 
        true and estimated location reflects realistic uncertainty due to noise, simplified 
        velocity assumptions, and grid resolution.
      </p>
    </section>

    <!-- INTERACTIVE PLOT CONTROLS -->
    <div style="text-align:center; margin-top:20px;">
      <label for="velSlider" style="color:white; font-weight:bold;">
        Velocity (m/s):
      </label>
      <input 
        type="range" 
        id="velSlider"
        min="1500" 
        max="4500" 
        value="2500" 
        step="100"
        oninput="updateVelocity(this.value)"
        style="width:100%; max-width:420px;"
      >
      <span id="velValue" style="color:white; margin-left:10px;">2500</span>
    </div>
    <div style="
      width:100%; max-width:420px;
      margin:4px auto 0 auto;
      display:flex;
      justify-content:space-between;
      color:#4d6aff;
      font-size:11px;
    ">
      <span>|</span>
      <span>|</span>
      <span>|</span>
      <span>|</span>
      <span>|</span>
      <span>|</span>
      <span>|</span>
    </div>

    <div style="
      width:100%; max-width:420px;
      margin:2px auto 0 auto;
      display:flex;
      justify-content:space-between;
      color:#4d6aff;
      font-size:11px;
    ">
      <span>1500</span>
      <span>2000</span>
      <span>2500</span>
      <span>3000</span>
      <span>3500</span>
      <span>4000</span>
      <span>4500</span>
    </div>


    <p style="
      color:#4da3ff;
      margin-top:6px;
      font-size:13px;
      font-style:italic;
      text-align:center;
    ">
      Adjust the assumed P‚Äëwave velocity used in the inversion. Higher velocity = faster travel times.
    </p>




    <!-- PLOT -->
    <div style="display:flex; justify-content:center; margin-top:20px;">
      <canvas id="level3Plot" width="700" height="400"></canvas>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", () => {

      const canvas = document.getElementById("level3Plot");
      const ctx3 = canvas.getContext("2d");

      const sx = 20;      // horizontal scale
      const sz = 10;      // vertical scale (reduced so true event is visible)
      

      function drawPoint(ctx, x, y, color, label, outline=false) {
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.arc(x, y, 7, 0, 2*Math.PI);
        ctx.fill();

        if (outline) {
          ctx.strokeStyle = "black";
          ctx.lineWidth = 2;
          ctx.stroke();
        }

        ctx.fillStyle = "white";
        ctx.fillText(label, x + 10, y + 4);
      }

      function drawPlot() {

          ctx3.fillStyle = "#1a1a1a";
          ctx3.fillRect(0, 0, canvas.width, canvas.height);

          // Title
          ctx3.fillStyle = "white";
          ctx3.font = "18px Arial";
          ctx3.fillText("Cross‚ÄëSection View (x vs depth)", 230, 30);

          // X-axis label
          ctx3.font = "14px Arial";
          ctx3.fillText("x (m)", 650, 380);

          // Y-axis label
          ctx3.save();
          ctx3.translate(20, 220);
          ctx3.rotate(-Math.PI / 2);
          ctx3.fillText("depth (m)", 0, 0);
          ctx3.restore();

          // Depth scale ticks
          ctx3.strokeStyle = "#888";
          ctx3.fillStyle = "#ccc";
          ctx3.font = "12px Arial";

          const baseline = 100;

          for (let d = 0; d >= -40; d -= 5) {
              let y = baseline - d * sz;
              ctx3.beginPath();
              ctx3.moveTo(45, y);
              ctx3.lineTo(60, y);
              ctx3.stroke();
              ctx3.fillText(d + " m", 65, y + 4);
          }

          // Geophones
          G.forEach((g, i) => {
              drawPoint(ctx3, g.x * sx, baseline, "cyan", "G" + i);
          });

          // True event
          drawPoint(
              ctx3,
              E_true.x * sx,
              baseline - E_true.z * sz,
              "lime",
              "True",
              true
          );

          // Estimated event
          drawPoint(
              ctx3,
              E_est.x * sx,
              baseline - E_est.z * sz,
              "red",
              "Estimated",
              true
          );
      }




      function updateVelocity(newVel) {
        document.getElementById("velValue").textContent = newVel + " m/s";
        v = Number(newVel);

        t_obs = G.map(g => travelTime(g, E_true, v) + (Math.random()*0.002 - 0.001));
        E_est = invertLocation(G, t_obs, v);

        drawPlot();
      }

      window.updateVelocity = updateVelocity;

      drawPlot();

    });
    </script>




    <p style="color:#d98c00; margin-top:10px; font-weight:500;">
      ‚ö†Ô∏è <strong>Note:</strong> In real microseismic monitoring, the true event location is 
      never known. Only the <em>estimated</em> location is available, and its accuracy 
      depends heavily on the velocity model. Adjusting the velocity slider above shows 
      how incorrect velocities distort the estimated position ‚Äî which is why mines rely 
      on sonic logs, calibration blasts, and iterative velocity updates.
    </p>
    
    <p style="color:#4d6aff; font-size:13px; font-style:italic; text-align:center; margin-top:12px;">
      ‚öôÔ∏è Future improvement: I plan to expand this section with more interactive controls to explore how velocity, geometry, and noise influence microseismic inversion.
    </p>

    <section style="margin-top:30px;">
    <h3>Potash Stratigraphy and Seismic Velocities</h3>

    <div style="max-width:260px; margin:10px auto; border:1px solid #ccc;">
      <div style="background:#f4e1c9; padding:6px; text-align:center; border-bottom:1px solid #ccc;">
        Sylvite<br><span style="font-size:11px; color:#555;">2500‚Äì3000 m/s</span>
      </div>
      <div style="background:#fbe0e6; padding:6px; text-align:center; border-bottom:1px solid #ccc;">
        Halite<br><span style="font-size:11px; color:#555;">~4500 m/s</span>
      </div>
      <div style="background:#e3e3e3; padding:6px; text-align:center; border-bottom:1px solid #ccc;">
        Anhydrite<br><span style="font-size:11px; color:#555;">~6000 m/s</span>
      </div>
      <div style="background:#e0d4c2; padding:6px; text-align:center;">
        Carbonate<br><span style="font-size:11px; color:#555;">5500‚Äì6500 m/s</span>
      </div>
    </div>

    <p style="text-align:center; font-size:12px; color:#555; margin-top:4px;">
      Stratigraphic order (top to bottom) and typical P-wave velocities. Solubility increases upward.
    </p>


    <!-- <div style="text-align:center; margin-top:10px;">
      <img src="/assets/images/potash_stratigraphy.png" 
          alt="Potash stratigraphy sketch"
          style="max-width:350px; width:90%; border-radius:6px;">
    </div> -->

    <p style="margin-top:15px;">
      In Saskatchewan potash mines, the stratigraphy typically transitions from 
      <strong>carbonate</strong> (limestone/dolomite) and <strong>anhydrite</strong> (CaSO‚ÇÑ) at the bottom 
      to <strong>halite</strong> (NaCl) and <strong>sylvite</strong> (KCl) near the top. 
      These evaporite units have distinct seismic velocities, and the strong contrast 
      between them plays a major role in microseismic travel‚Äëtime behavior and inversion accuracy.
    </p>


    <table style="width:100%; border-collapse:collapse; margin-top:20px; font-size:14px;">
      <thead>
        <tr style="background:#f2f2f2;">
          <th style="padding:8px; border:1px solid #ccc;">Material</th>
          <th style="padding:8px; border:1px solid #ccc;">Velocity (m/s)</th>
          <th style="padding:8px; border:1px solid #ccc;">Notes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Air</td>
          <td style="padding:8px; border:1px solid #ccc;">~330</td>
          <td style="padding:8px; border:1px solid #ccc;">Extremely compressible</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Unsaturated weathering layer</td>
          <td style="padding:8px; border:1px solid #ccc;">300‚Äì1500</td>
          <td style="padding:8px; border:1px solid #ccc;">Loose grains, air-filled pores</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Seawater</td>
          <td style="padding:8px; border:1px solid #ccc;">~1500</td>
          <td style="padding:8px; border:1px solid #ccc;">High bulk modulus, uniform</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Soft marine sediments</td>
          <td style="padding:8px; border:1px solid #ccc;">1400‚Äì1800</td>
          <td style="padding:8px; border:1px solid #ccc;">Slightly lower or higher than seawater</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Sylvite (KCl)</td>
          <td style="padding:8px; border:1px solid #ccc;">2500‚Äì3000</td>
          <td style="padding:8px; border:1px solid #ccc;">Main potash mineral</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Potash ore mixture</td>
          <td style="padding:8px; border:1px solid #ccc;">2000‚Äì3000</td>
          <td style="padding:8px; border:1px solid #ccc;">Sylvite + halite + insolubles</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Halite (NaCl)</td>
          <td style="padding:8px; border:1px solid #ccc;">~4500</td>
          <td style="padding:8px; border:1px solid #ccc;">Strong evaporite</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Sandstone</td>
          <td style="padding:8px; border:1px solid #ccc;">2500‚Äì4500</td>
          <td style="padding:8px; border:1px solid #ccc;">Depends on compaction</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Shale</td>
          <td style="padding:8px; border:1px solid #ccc;">2500‚Äì3500</td>
          <td style="padding:8px; border:1px solid #ccc;">Highly variable</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Limestone</td>
          <td style="padding:8px; border:1px solid #ccc;">5500‚Äì6000</td>
          <td style="padding:8px; border:1px solid #ccc;">High stiffness</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Dolomite</td>
          <td style="padding:8px; border:1px solid #ccc;">6000‚Äì6500</td>
          <td style="padding:8px; border:1px solid #ccc;">Very stiff</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Anhydrite</td>
          <td style="padding:8px; border:1px solid #ccc;">~6000</td>
          <td style="padding:8px; border:1px solid #ccc;">Strong evaporite</td>
        </tr>
        <tr>
          <td style="padding:8px; border:1px solid #ccc;">Basement rocks</td>
          <td style="padding:8px; border:1px solid #ccc;">5500‚Äì7000+</td>
          <td style="padding:8px; border:1px solid #ccc;">High density, high modulus</td>
        </tr>
      </tbody>
    </table>



    <p style="text-align:center; color:#888; font-size:12px; margin-top:4px;">
      Typical seismic velocities for common geological materials.
      Adapted from typical potash and evaporite velocity ranges reported in mining geophysics literature.
    </p>
  </section>
  
  <h3 style="margin-top:25px;">Improving Microseismic Location Accuracy</h3>
  <p>
    Microseismic accuracy depends strongly on the velocity model and the physical 
    properties of the surrounding units. In practice, location quality can be 
    improved by integrating additional geophysical methods such as:
  </p>
  <ul>
    <li><strong>GPR (Ground Penetrating Radar)</strong> ‚Äì high‚Äëresolution imaging of shallow structures.</li>
    <li><strong>EM / MT</strong> ‚Äì mapping resistivity contrasts that correlate with lithology changes.</li>
    <li><strong>Seismic refraction</strong> ‚Äì constraining near‚Äësurface velocity variations.</li>
    <li><strong>Borehole geophysics</strong> ‚Äì direct measurement of P‚Äë and S‚Äëwave velocities.</li>
  </ul>
  <p>
    These methods provide independent constraints that reduce uncertainty in the 
    velocity model and improve the reliability of microseismic event locations.
  </p>
  <!--
  <p>Related projects: 
    <a href="/case-studies/applied-geophysics/gpr/">GPR demo</a>, 
    <a href="/case-studies/applied-geophysics/em-mt/">EM/MT example</a>, 
    <a href="/case-studies/applied-geophysics/refraction/">Seismic refraction</a>.
  </p> 
  -->



      
    


  </main>

  <!-- FOOTER -->
  <div id="footer"></div>

  <script>
    async function loadComponent(id, file) {
      const container = document.getElementById(id);
      const response = await fetch(file);
      const html = await response.text();
      container.innerHTML = html;
    }
 
    loadComponent("header", "/components/header.html");
    loadComponent("footer", "/components/footer.html");
  </script>

  <script>
  function toggleSection(id) {
    const box = document.getElementById(id);
    if (!box) return;
    box.classList.toggle("open");
  }
  </script>


</body>
</html>
